# IRPO Resource Planning Toolkit

This repository collects the input datasets and Python scripts that accompany the
IRPO (Integrated Resource Planning Optimization) paper.  It contains three
alternative solvers for the matching problem tackled in the publication as well
as the helper utilities that build the bipartite cost structures and report the
quality of the assignments they produce.

## Repository layout

| Path | Description |
|------|-------------|
| `MCMmethod.py` | Wrapper around the optimal matching solver proposed in the paper.  It builds a weighted bipartite instance and delegates the optimization to `bipartite_matchings_tool.exe`. |
| `IntelligentGreedy.py` | Greedy heuristic that prioritises the cheapest feasible assignment at each iteration. |
| `naiveAlgorithm.py` | Baseline greedy heuristic that prioritises the highest matching-score resource first. |
| `RPOstoreData.py` | Helper routines for extracting the modelling parameters (qualified resources, lead times, costs, etc.) from the Excel workbook used in the study. |
| `rpoBipartite.py` | Direct Gurobi implementation of the bipartite formulation (requires `gurobipy` and an active licence). |
| `OutRPO_*.csv` | Example outputs created by running the algorithms.  They showcase the format generated by each solver. |
| `parametersMarcos_solution.txt` | Sample parameter dump describing an instance and its optimal assignment. |
| `bipartite_matchings_tool.exe` | External solver binary used by `MCMmethod.py` to compute the minimum-cost matching. |

## Requirements

All scripts are written for Python 3.  Besides the standard library, different
components expect the following third-party tools:

* `xlwings` – used by `RPOstoreData.py` and `rpoBipartite.py` to read the
  `RPOdata.xlsx` workbook that stores the problem data.
* `gurobipy` – only required when using `rpoBipartite.py`.
* `bipartite_matchings_tool.exe` – Windows executable bundled in the repository;
  the optimal `MCMmethod` relies on it being present in the working directory.

> **Note:** The repository ships only the Python code and the sample outputs.  A
> matching score matrix (for example `MatchingScoreV8.csv`) and the Excel
> workbook `RPOdata.xlsx` referenced by the helper functions must be supplied by
> the user.  Paths to these assets are configured directly inside the scripts.

## Preparing an instance

All three Python entry points share the same helper routines.  To run any of the
methods you must:

1. **Provide a matching-score matrix** – a CSV file whose rows correspond to the
   available resources and whose columns correspond to the open positions.
   Update the `archivoMS` variable near the bottom of each script so that it
   points to the location of this file.
2. **Set the random seed** – the `semilla` variable controls the reproducibility
   of the synthetic scenarios generated by `crearDatosbase`.
3. **(Optional) Tune scenario parameters** – all modelling assumptions (demand
   profiles, readiness dates, training times, hiring limits, cost factors, …)
   can be customised inside the `crearDatosbase` function if you wish to explore
   different use cases.

Running a script automatically:

* reads the matching-score matrix,
* samples a planning instance,
* transforms it into a bipartite assignment cost structure, and
* solves it with the chosen method.

## Using the solvers

Run any of the Python scripts with `python <script-name>.py`.  The following
behaviour is common across implementations:

* `CrearArchivoSAlida` builds the problem definition and writes a human-readable
  dump (`parametersFile.txt`) describing the generated parameters and costs.
* `solve_*` computes the assignment, either with the optimal solver or with a
  heuristic.
* `computeJObsData`, `computeVisualization`, and `computeKPI` post-process the
  solution and export the CSV summaries described below.

### Output files

Every run produces three CSV artefacts (the suffix reflects the chosen method):

* `OutRPO_Positions_*.csv` – detailed assignment for each position.  The columns
  list the position identifier, the resource assigned, start dates, filled
  months, and the cost incurred by the assignment.
* `OutRPO_PositionsVisual_*.csv` – timeline view of the same assignments, where
  each period is marked with `1` if the position is staffed or `0` if it remains
  a gap.
* `OutRPO_KPI_*.csv` – key performance indicators such as coverage of demand,
  internal capacity utilisation, number of hires, and aggregated costs.

These formats mirror the tables discussed in the paper and match the sample
files stored alongside the code.

## Troubleshooting

* The example scripts default to Windows-style absolute paths.  Update the
  `archivoMS` variable to a path that exists on your machine before running the
  solver.
* If you do not have access to Gurobi, skip `rpoBipartite.py` and rely on the
  heuristics or the external matching tool instead.
* When using the Excel-based workflow you must have Excel installed and
  accessible to `xlwings`.

For further questions about the experiments or the intended scenarios, please
refer to the original IRPO publication.
